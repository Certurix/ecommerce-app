# Coolify deployment configuration
# This file can be used by Coolify to understand the deployment requirements

# Application configuration
name: ecommerce-app
type: docker-compose

# Build configuration
build:
  dockerfile: Dockerfile
  context: .

# Environment variables that need to be configured in Coolify
environment:
  # Database configuration
  - DB_HOST=db
  - DB_PORT=3306
  - DB_NAME=ecommerce
  - DB_USER=ecommerce
  - DB_PASSWORD=${DB_PASSWORD}
  - DB_DIALECT=mysql
  - DB_ROOT_PASSWORD=${DB_ROOT_PASSWORD}
  
  # Application configuration
  - NODE_ENV=production
  - PORT=5000

# Port configuration
ports:
  - "5000:5000"

# Health check configuration
healthcheck:
  test: ["CMD-SHELL", "curl -f http://localhost:5000/api/health || exit 1"]
  interval: 30s
  timeout: 10s
  retries: 3
  start_period: 40s

# Volumes
volumes:
  - mysql_data:/var/lib/mysql

# Dependencies
depends_on:
  - mysql